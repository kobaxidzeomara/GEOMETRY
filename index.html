<!DOCTYPE html>
<html lang="ka">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>áƒ¤áƒáƒœáƒ¯áƒ áƒ˜áƒ¡ áƒ­áƒ áƒ˜áƒ¡ áƒ™áƒ£áƒ—áƒ®áƒ˜áƒ¡ áƒ™áƒáƒšáƒ™áƒ£áƒšáƒáƒ¢áƒáƒ áƒ˜ â€” áƒ’áƒáƒ£áƒ›áƒ¯áƒáƒ‘áƒ”áƒ¡áƒ”áƒ‘áƒ£áƒšáƒ˜</title>
<style>
  :root {
    --accent:#0a8cff;
    --accent2:#ff3b3b;
    --bg:#f5f7ff;
    --card:#fff;
    --input-border:#dce4f5;
  }

  *{box-sizing:border-box;}
  body{
    font-family:Inter,Segoe UI,Arial,sans-serif;
    background:var(--bg);
    margin:0;
    padding:20px;
    display:flex;
    justify-content:center;
    min-height:100vh;
  }

  .wrap{
    width:1100px;
    max-width:100%;
    display:grid;
    grid-template-columns:380px 1fr;
    gap:20px;
    align-items:start;
  }

  .card{
    background:var(--card);
    padding:24px;
    border-radius:16px;
    box-shadow:0 8px 25px rgba(20,30,60,0.12);
    transition:0.2s;
  }
  .card:hover{ box-shadow:0 12px 30px rgba(20,30,60,0.18); }

  h2{ margin:0 0 18px; font-size:20px; font-weight:700; color:#1a1a1a; }
  h3{ margin:18px 0 10px; font-size:18px; font-weight:600; color:#333; }

  label{
    display:block;
    font-size:15px;
    font-weight:500;
    margin-top:12px;
    color:#444;
  }

  input[type=number]{
    width:100%;
    padding:12px 14px;
    border-radius:10px;
    border:2px solid var(--input-border);
    font-size:15px;
    margin-top:8px;
    transition:border .2s, box-shadow .2s;
  }
  input[type=number]:focus{
    outline:0;
    border-color:var(--accent);
    box-shadow:0 0 6px rgba(10,140,255,0.3);
  }

  .shape-selector{
    display:grid;
    grid-template-columns:1fr 1fr;
    gap:10px;
    margin-bottom:12px;
  }
  .shape-btn{
    padding:12px;
    border-radius:12px;
    border:2px solid var(--input-border);
    background:#fff;
    cursor:pointer;
    font-size:15px;
    font-weight:600;
    transition:all .18s;
    text-align:center;
  }
  .shape-btn:hover{ border-color:var(--accent); transform:translateY(-2px);}
  .shape-btn.active{ background:var(--accent); color:#fff; border-color:var(--accent); box-shadow:0 6px 16px rgba(10,140,255,0.25); }

  .tri-type-selector{
    display:none;
    grid-template-columns:1fr 1fr 1fr 1fr;
    gap:10px;
    margin-bottom:10px;
  }
  .tri-type-selector.active{ display:grid; }
  .tri-type-btn{
    padding:10px;
    border-radius:10px;
    border:2px solid var(--input-border);
    background:#fff;
    cursor:pointer;
    font-size:13px;
    font-weight:500;
    transition:all .18s;
    text-align:center;
  }
  .tri-type-btn:hover{ border-color:var(--accent); }
  .tri-type-btn.active{ background:var(--accent2); color:#fff; border-color:var(--accent2); }

  .inputs-group{ display:none; }
  .inputs-group.active{ display:block; }

  .btn-group{ display:flex; gap:10px; margin-top:12px; flex-wrap:wrap; }
  .btn{
    padding:12px;
    background:var(--accent);
    color:#fff;
    border:0;
    border-radius:10px;
    cursor:pointer;
    font-size:15px;
    font-weight:600;
    transition:all .18s;
    flex:1 1 calc(50% - 5px);
  }
  .btn:hover{ transform:translateY(-1px); box-shadow:0 6px 16px rgba(10,140,255,0.2); }
  .btn-reset{ background:#ff3b3b; color:#fff; }
  .btn-reset:hover{ box-shadow:0 6px 16px rgba(255,59,59,0.2); }

  .result{
    margin-top:12px;
    font-size:14px;
    background:#f0f7ff;
    padding:14px;
    border-radius:12px;
    border:1px solid #d0e4ff;
    max-height:480px;
    overflow:auto;
  }

  .small{ font-size:13px; color:#666; margin-top:8px; line-height:1.5; }

  .svgbox{
    display:flex;
    align-items:center;
    justify-content:center;
    background:#fff;
    border-radius:12px;
    padding:20px;
    box-shadow:0 6px 25px rgba(20,30,60,0.08);
    min-height:560px;
    transition:0.2s;
  }
  .svgbox:hover{ box-shadow:0 10px 30px rgba(20,30,60,0.12); }

  svg{ width:100%; height:100%; max-height:560px; }

  table{ width:100%; border-collapse:collapse; font-size:14px; margin-top:10px; }
  td,th{ padding:8px 10px; border-bottom:1px solid #f0f3f8; text-align:left; }
  th{ background:#f5f8fc; font-weight:600; color:#555; font-size:14px; }

  .edge-selector{ margin-top:12px; }
  .edge-label{ font-size:15px; font-weight:500; color:#555; margin-bottom:10px; }
  .edge-btns{ display:grid; grid-template-columns:1fr 1fr; gap:8px; }
  .edge-btns.tri{ grid-template-columns:1fr 1fr 1fr; }

  .edgeBtn{
    padding:10px;
    border-radius:10px;
    border:2px solid var(--input-border);
    background:#fff;
    cursor:pointer;
    font-size:14px;
    font-weight:500;
    transition:all .18s;
    text-align:center;
  }
  .edgeBtn:hover{ border-color:var(--accent2); background:#fff0f0; }
  .edgeBtn.active{ background:var(--accent2); color:#fff; border-color:var(--accent2); }

  .note{
    font-size:14px;
    color:#666;
    background:#fff7f7;
    padding:10px;
    border-radius:10px;
    margin-top:12px;
    line-height:1.5;
    border-left:4px solid var(--accent2);
  }

  .highlight{ color:var(--accent); font-weight:600; }
  .warning{ background:#fff3e0; border-left-color:var(--accent2); color:#c85e00; }

  /* ===== RESPONSIVE ===== */
  @media(max-width:1100px){
    .wrap{ grid-template-columns:1fr; gap:16px; }
    .svgbox{ min-height:450px; }
  }

  @media(max-width:768px){
    body{ padding:12px; }
    .card{ padding:16px; }
    .btn{ flex:1 1 100%; }
    .shape-selector{ grid-template-columns:1fr 1fr; gap:8px; }
    .tri-type-selector{ grid-template-columns:1fr 1fr 1fr 1fr; gap:6px; }
  }

  @media(max-width:480px){
    h2{ font-size:18px; }
    h3{ font-size:16px; }
    label{ font-size:14px; }
    input[type=number]{ font-size:14px; padding:10px; }
    .svgbox{ min-height:350px; padding:16px; }
    .btn{ font-size:14px; padding:10px; }
  }
</style>


</head>
<body>
  <div class="wrap">
    <div class="card" aria-labelledby="controlsTitle">
      <h2 id="controlsTitle">ğŸ“ áƒ¤áƒ˜áƒ’áƒ£áƒ áƒ˜áƒ¡ áƒ¢áƒ˜áƒáƒ˜</h2>
      <div class="shape-selector" role="tablist">
        <button class="shape-btn" data-shape="triangle" id="btnTriangle">ğŸ”º áƒ¡áƒáƒ›áƒ™áƒ£áƒ—áƒ®áƒ”áƒ“áƒ˜</button>
        <button class="shape-btn active" data-shape="quad" id="btnQuad">â—¼ï¸ áƒáƒ—áƒ®áƒ™áƒ£áƒ—áƒ®áƒ”áƒ“áƒ˜</button>
      </div>

      <div class="tri-type-selector" id="triTypeSelector" aria-hidden="true">
        <button class="tri-type-btn active" data-type="custom">ğŸ”§ áƒœáƒ”áƒ‘áƒ˜áƒ¡áƒ›áƒ˜áƒ”áƒ áƒ˜</button>
        <button class="tri-type-btn" data-type="right">ğŸ“ áƒ›áƒáƒ áƒ—áƒ™áƒ£áƒ—áƒ®áƒ</button>
        <button class="tri-type-btn" data-type="equilateral">âš–ï¸ áƒ¢áƒáƒšáƒ’áƒ•áƒ”áƒ áƒ“áƒ</button>
        <button class="tri-type-btn" data-type="isosceles">ğŸ“ áƒ¢áƒáƒšáƒ¤áƒ”áƒ áƒ“áƒ</button>
      </div>

      <h2>ğŸ“ áƒ–áƒáƒ›áƒ”áƒ‘áƒ˜</h2>

      <div class="inputs-group" id="triangleCustom">
        <label for="tri_a">áƒ’áƒ•áƒ”áƒ áƒ“áƒ˜ A (áƒ›áƒ›)</label>
        <input id="tri_a" type="number" step="1" value="800" placeholder="áƒ›áƒáƒ’: 800">
        <label for="tri_b">áƒ’áƒ•áƒ”áƒ áƒ“áƒ˜ B (áƒ›áƒ›)</label>
        <input id="tri_b" type="number" step="1" value="900" placeholder="áƒ›áƒáƒ’: 900">
        <label for="tri_c">áƒ’áƒ•áƒ”áƒ áƒ“áƒ˜ C (áƒ›áƒ›)</label>
        <input id="tri_c" type="number" step="1" value="1000" placeholder="áƒ›áƒáƒ’: 1000">
      </div>

      <div class="inputs-group" id="triangleRight">
        <label for="tri_right_height">áƒ¡áƒ˜áƒ›áƒáƒ¦áƒšáƒ” (áƒ›áƒ›)</label>
        <input id="tri_right_height" type="number" step="1" value="1500" placeholder="áƒ›áƒáƒ’: 1500">
        <label for="tri_right_width">áƒ¡áƒ˜áƒ’áƒáƒœáƒ” (áƒ›áƒ›)</label>
        <input id="tri_right_width" type="number" step="1" value="1000" placeholder="áƒ›áƒáƒ’: 1000">
        <div class="small">âœ“ áƒ›áƒáƒ áƒ—áƒ™áƒ£áƒ—áƒ®áƒ áƒ¡áƒáƒ›áƒ™áƒ£áƒ—áƒ®áƒ”áƒ“áƒ˜ (90Â°) â€” áƒ°áƒ˜áƒáƒáƒ¢áƒ”áƒœáƒ£áƒ–áƒ áƒ’áƒáƒ›áƒáƒ˜áƒ—áƒ•áƒšáƒ”áƒ‘áƒ.</div>
      </div>

      <div class="inputs-group" id="triangleEquilateral">
        <label for="tri_eq_side">áƒ’áƒ•áƒ”áƒ áƒ“áƒ˜ (áƒ›áƒ›)</label>
        <input id="tri_eq_side" type="number" step="1" value="1000" placeholder="áƒ›áƒáƒ’: 1000">
        <div class="small">âœ“ áƒ§áƒ•áƒ”áƒšáƒ áƒ™áƒ£áƒ—áƒ®áƒ” 60Â°</div>
      </div>

      <div class="inputs-group" id="triangleIsosceles">
        <label for="tri_iso_base">áƒ¤áƒ£áƒ«áƒ” (áƒ›áƒ›)</label>
        <input id="tri_iso_base" type="number" step="1" value="1200" placeholder="áƒ›áƒáƒ’: 1200">
        <label for="tri_iso_side">áƒ—áƒáƒœáƒáƒ‘áƒáƒ áƒ˜ áƒ’áƒ•áƒ”áƒ áƒ“áƒ”áƒ‘áƒ˜ (áƒ›áƒ›)</label>
        <input id="tri_iso_side" type="number" step="1" value="1000" placeholder="áƒ›áƒáƒ’: 1000">
      </div>

      <div class="inputs-group active" id="quadInputs">
        <label for="quad_a">áƒ–áƒ”áƒ“áƒ áƒ¡áƒ˜áƒ’áƒáƒœáƒ” a (áƒ›áƒ›)</label>
        <input id="quad_a" type="number" step="1" value="800" placeholder="áƒ›áƒáƒ’: 800">
        <label for="quad_b">áƒ¥áƒ•áƒ”áƒ“áƒ áƒ¡áƒ˜áƒ’áƒáƒœáƒ” b (áƒ›áƒ›)</label>
        <input id="quad_b" type="number" step="1" value="950" placeholder="áƒ›áƒáƒ’: 950">
        <label for="quad_h1">áƒ¡áƒ˜áƒ›áƒáƒ¦áƒšáƒ” áƒ›áƒáƒ áƒªáƒ®áƒœáƒ˜áƒ• hâ‚ (áƒ›áƒ›)</label>
        <input id="quad_h1" type="number" step="1" value="1500" placeholder="áƒ›áƒáƒ’: 1500">
        <label for="quad_h2">áƒ¡áƒ˜áƒ›áƒáƒ¦áƒšáƒ” áƒ›áƒáƒ áƒ¯áƒ•áƒœáƒ˜áƒ• hâ‚‚ (áƒ›áƒ›)</label>
        <input id="quad_h2" type="number" step="1" value="1500" placeholder="áƒ›áƒáƒ’: 1500">
      </div>

      <div class="btn-group">
        <button class="btn" id="calcBtn">ğŸ”„ áƒ’áƒáƒ›áƒáƒ—áƒ•áƒšáƒ</button>
        <button class="btn btn-reset" id="resetBtn">ğŸ—‘ï¸ áƒ¬áƒáƒ¨áƒšáƒ</button>
      </div>

      <div class="edge-selector">
        <div class="edge-label">áƒáƒ˜áƒ áƒ©áƒ˜áƒ” áƒ’áƒ•áƒ”áƒ áƒ“áƒ˜:</div>
        <div class="edge-btns" id="edgeBtnsContainer"></div>
      </div>

      <div class="note">
        ğŸ’¡ <strong>áƒ­áƒ áƒ˜áƒ¡ áƒ™áƒ£áƒ—áƒ®áƒ”</strong> = áƒ¨áƒ˜áƒ“áƒ áƒ™áƒ£áƒ—áƒ®áƒ˜áƒ¡ Â½<br>
        áƒ¨áƒ˜áƒ“áƒ áƒ™áƒ£áƒ—áƒ®áƒ” = áƒáƒ áƒ˜ áƒ’áƒ•áƒ”áƒ áƒ“áƒ˜áƒ¡ áƒ™áƒ•áƒ”áƒ—áƒ˜áƒ¡ áƒ™áƒ£áƒ—áƒ®áƒ”
      </div>

      <div id="results" class="result">áƒáƒ˜áƒ áƒ©áƒ˜áƒ” áƒ¤áƒ˜áƒ’áƒ£áƒ áƒ, áƒ©áƒáƒ¬áƒ”áƒ áƒ” áƒ–áƒáƒ›áƒ”áƒ‘áƒ˜ áƒ“áƒ áƒ“áƒáƒáƒ­áƒ˜áƒ áƒ” "áƒ’áƒáƒ›áƒáƒ—áƒ•áƒšáƒ˜áƒšáƒ¡" ğŸ‘†</div>
    </div>

    <div class="card svgbox">
      <svg id="svg" viewBox="0 0 700 560" preserveAspectRatio="xMidYMid meet" xmlns="http://www.w3.org/2000/svg">
        <defs>
          <filter id="shadow">
            <feDropShadow dx="0" dy="2" stdDeviation="3" flood-opacity="0.15"/>
          </filter>
        </defs>
        <g id="drawing"></g>
      </svg>
    </div>
  </div>

<script>
'use strict';
/* ---------- state ---------- */
const state = {
  currentShape: 'quad',
  currentTriType: 'custom',
  lastComputation: null,
  activeEdge: 'right'
};

/* ---------- helpers ---------- */
const el = id => document.getElementById(id);
const svgGroup = el('drawing');
const resultsEl = el('results');
const edgeBtnsContainer = el('edgeBtnsContainer');

function dot(u,v){return u.x*v.x + u.y*v.y}
function len(v){return Math.hypot(v.x,v.y)}
function angleBetween(u,v){return Math.acos(Math.max(-1,Math.min(1,dot(u,v)/(len(u)*len(v)))));}
function interiorAngleAt(prev,P,next){
  const v1={x:prev.x-P.x,y:prev.y-P.y};
  const v2={x:next.x-P.x,y:next.y-P.y};
  return angleBetween(v1,v2);
}
function edgeLength(P,Q){return Math.hypot(Q.x-P.x,Q.y-P.y)}

/* ---------- geometry ---------- */
function computeTriangle(a,b,c){
  const angleA = Math.acos((b*b + c*c - a*a)/(2*b*c));
  const angleB = Math.acos((a*a + c*c - b*b)/(2*a*c));
  const A={x:0,y:0}, B={x:c,y:0}, C={x:b*Math.cos(angleA),y:b*Math.sin(angleA)};
  const pts={A,B,C}, order=[A,B,C], names=['A','B','C'];
  const vertices={};
  for(let i=0;i<3;i++){
    const P=order[i], prev=order[(i+2)%3], next=order[(i+1)%3];
    const ang = interiorAngleAt(prev,P,next);
    vertices[names[i]]={x:P.x,y:P.y,interior_deg:ang*180/Math.PI, cut_deg:(ang*180/Math.PI)/2};
  }
  const edges = {ab:{P:A,Q:B,pName:'A',qName:'B'}, bc:{P:B,Q:C,pName:'B',qName:'C'}, ca:{P:C,Q:A,pName:'C',qName:'A'}};
  for(const k in edges){
    const e=edges[k];
    e.length=edgeLength(e.P,e.Q);
    e.pInterior=vertices[e.pName].interior_deg;
    e.qInterior=vertices[e.qName].interior_deg;
    e.pCut=vertices[e.pName].cut_deg;
    e.qCut=vertices[e.qName].cut_deg;
  }
  return {pts,vertices,edges,shape:'triangle'};
}

function computeTriangleRightFromBaseHeight(base, height){
  const A={x:0,y:0}, B={x:base,y:0}, C={x:0,y:height};
  const pts={A,B,C}, order=[A,B,C], names=['A','B','C'];
  const vertices={};
  for(let i=0;i<3;i++){
    const P=order[i], prev=order[(i+2)%3], next=order[(i+1)%3];
    const ang=interiorAngleAt(prev,P,next);
    vertices[names[i]]={x:P.x,y:P.y,interior_deg:ang*180/Math.PI, cut_deg:(ang*180/Math.PI)/2};
  }
  const edges={ab:{P:A,Q:B,pName:'A',qName:'B'}, bc:{P:B,Q:C,pName:'B',qName:'C'}, ca:{P:C,Q:A,pName:'C',qName:'A'}};
  for(const k in edges){
    const e=edges[k];
    e.length=edgeLength(e.P,e.Q);
    e.pInterior=vertices[e.pName].interior_deg;
    e.qInterior=vertices[e.qName].interior_deg;
    e.pCut=vertices[e.pName].cut_deg;
    e.qCut=vertices[e.qName].cut_deg;
  }
  return {pts,vertices,edges,shape:'triangle'};
}

function computeQuad(a,b,h1,h2){
  const TL={x:0,y:0}, TR={x:a,y:0}, BR={x:b,y:h2}, BL={x:0,y:h1};
  const pts={TL,TR,BR,BL}, order=[TL,TR,BR,BL], names=['TL','TR','BR','BL'];
  const vertices={};
  for(let i=0;i<4;i++){
    const P=order[i], prev=order[(i+3)%4], next=order[(i+1)%4];
    const ang=interiorAngleAt(prev,P,next);
    vertices[names[i]]={x:P.x,y:P.y,interior_deg:ang*180/Math.PI, cut_deg:(ang*180/Math.PI)/2};
  }
  const edges={top:{P:TL,Q:TR,pName:'TL',qName:'TR'}, right:{P:TR,Q:BR,pName:'TR',qName:'BR'}, bottom:{P:BR,Q:BL,pName:'BR',qName:'BL'}, left:{P:BL,Q:TL,pName:'BL',qName:'TL'}};
  for(const k in edges){
    const e=edges[k];
    e.length=edgeLength(e.P,e.Q);
    e.pInterior=vertices[e.pName].interior_deg;
    e.qInterior=vertices[e.qName].interior_deg;
    e.pCut=vertices[e.pName].cut_deg;
    e.qCut=vertices[e.qName].cut_deg;
  }
  return {pts,vertices,edges,shape:'quad'};
}

/* ---------- UI ---------- */
function setActiveEdge(name){
  state.activeEdge=name;
  updateEdgeButtonsUI();
  if(state.lastComputation) renderResults(state.lastComputation);
}
function updateEdgeButtonsUI(){
  const btns=edgeBtnsContainer.querySelectorAll('.edgeBtn');
  btns.forEach(b=>b.classList.toggle('active',b.dataset.edge===state.activeEdge));
  svgGroup.querySelectorAll('line[data-edge]').forEach(l=>{
    if(l.getAttribute('data-edge')===state.activeEdge){l.setAttribute('stroke','#ff6b00');l.setAttribute('stroke-width','6');}
    else {l.setAttribute('stroke','#2b6be6');l.setAttribute('stroke-width','4');}
  });
}
function createEdgeButtons(data){
  edgeBtnsContainer.innerHTML='';
  Object.keys(data.edges).forEach(key=>{
    const btn=document.createElement('button');
    btn.className='edgeBtn'; btn.dataset.edge=key; btn.type='button'; btn.textContent=key.toUpperCase();
    btn.addEventListener('click',()=>setActiveEdge(key));
    edgeBtnsContainer.appendChild(btn);
  });
  if(!Object.keys(data.edges).includes(state.activeEdge)) state.activeEdge=Object.keys(data.edges)[0];
  updateEdgeButtonsUI();
}

/* ---------- render ---------- */
function renderSVG(data){
  svgGroup.innerHTML='';
  const pts=Object.values(data.pts);
  const xs=pts.map(p=>p.x), ys=pts.map(p=>p.y);
  const minX=Math.min(...xs), maxX=Math.max(...xs), minY=Math.min(...ys), maxY=Math.max(...ys);
  const width=Math.max(1,maxX-minX), height=Math.max(1,maxY-minY);
  const viewW=520, viewH=420, scale=Math.min(viewW/width,viewH/height);
  function S(p){return {x:(p.x-minX)*scale+80, y:(maxY-p.y)*scale+60};}
  const scaled={}; for(const k in data.pts) scaled[k]=S(data.pts[k]);
  const poly=document.createElementNS('http://www.w3.org/2000/svg','polygon');
  poly.setAttribute('points',Object.values(scaled).map(p=>`${p.x},${p.y}`).join(' '));
  poly.setAttribute('fill','#fafcff'); poly.setAttribute('stroke','#99c2ff'); poly.setAttribute('stroke-width','3'); poly.setAttribute('filter','url(#shadow)');
  svgGroup.appendChild(poly);
  for(const key in data.edges){
    const e=data.edges[key], pA=scaled[e.pName], pB=scaled[e.qName];
    const g=document.createElementNS('http://www.w3.org/2000/svg','g');
    const line=document.createElementNS('http://www.w3.org/2000/svg','line');
    line.setAttribute('x1',pA.x); line.setAttribute('y1',pA.y); line.setAttribute('x2',pB.x); line.setAttribute('y2',pB.y);
    line.setAttribute('stroke','#2b6be6'); line.setAttribute('stroke-width','4'); line.setAttribute('stroke-linecap','round');
    line.setAttribute('data-edge',key); line.style.cursor='pointer';
    line.addEventListener('click',()=>setActiveEdge(key));
    g.appendChild(line);
    const mx=(pA.x+pB.x)/2,my=(pA.y+pB.y)/2;
    const text=document.createElementNS('http://www.w3.org/2000/svg','text');
    text.setAttribute('x',mx); text.setAttribute('y',my-12); text.setAttribute('text-anchor','middle');
    text.setAttribute('font-size','13'); text.setAttribute('font-weight','600'); text.setAttribute('fill','#0b3b99');
    text.textContent=`${Math.round(e.length)} mm`;
    g.appendChild(text);
    svgGroup.appendChild(g);
  }
  for(const name in data.vertices){
    const v=data.vertices[name], p=scaled[name];
    const c=document.createElementNS('http://www.w3.org/2000/svg','circle');
    c.setAttribute('cx',p.x); c.setAttribute('cy',p.y); c.setAttribute('r','6'); c.setAttribute('fill','#0b3b99'); c.setAttribute('stroke','#fff'); c.setAttribute('stroke-width','2');
    svgGroup.appendChild(c);
    const t=document.createElementNS('http://www.w3.org/2000/svg','text');
    t.setAttribute('x',p.x+10); t.setAttribute('y',p.y+6); t.setAttribute('font-size','12'); t.setAttribute('font-weight','700'); t.setAttribute('fill','#1a1a1a');
    t.textContent=name; svgGroup.appendChild(t);
  }
  updateEdgeButtonsUI();
}

/* ---------- results ---------- */
function renderResults(data){
  if(!data){resultsEl.innerHTML='<div style="color:#999">áƒáƒ˜áƒ áƒ•áƒ”áƒšáƒáƒ“ áƒ“áƒáƒáƒ­áƒ˜áƒ áƒ” "áƒ’áƒáƒ›áƒáƒ—áƒ•áƒšáƒáƒ¡" ğŸ‘†</div>';return;}
  state.lastComputation=data;
  const e=data.edges[state.activeEdge];
  let html=`<h3>ğŸ“ áƒáƒ áƒ©áƒ”áƒ£áƒšáƒ˜ áƒ’áƒ•áƒ”áƒ áƒ“áƒ˜: <span class="highlight">${state.activeEdge.toUpperCase()}</span></h3>`;
  html+=`<table><thead><tr><th>áƒáƒáƒ áƒáƒ›áƒ”áƒ¢áƒ áƒ˜</th><th>áƒ¦áƒ˜áƒ áƒ”áƒ‘áƒ£áƒšáƒ”áƒ‘áƒ</th></tr></thead><tbody>`;
  html+=`<tr><td><strong>áƒ¡áƒ˜áƒ’áƒ áƒ«áƒ”</strong></td><td><strong>${e.length.toFixed(1)} mm</strong></td></tr>`;
  html+=`<tr><td>áƒ¬áƒ•áƒ”áƒ áƒ˜ ${e.pName} â€” áƒ¨áƒ˜áƒ“áƒ áƒ™áƒ£áƒ—áƒ®áƒ”</td><td>${e.pInterior.toFixed(2)}Â°</td></tr>`;
  html+=`<tr><td>áƒ¬áƒ•áƒ”áƒ áƒ˜ ${e.pName} â€” áƒ­áƒ áƒ˜áƒ¡ áƒ™áƒ£áƒ—áƒ®áƒ”</td><td><strong>${e.pCut.toFixed(2)}Â°</strong></td></tr>`;
  html+=`<tr><td>áƒ¬áƒ•áƒ”áƒ áƒ˜ ${e.qName} â€” áƒ¨áƒ˜áƒ“áƒ áƒ™áƒ£áƒ—áƒ®áƒ”</td><td>${e.qInterior.toFixed(2)}Â°</td></tr>`;
  html+=`<tr><td>áƒ¬áƒ•áƒ”áƒ áƒ˜ ${e.qName} â€” áƒ­áƒ áƒ˜áƒ¡ áƒ™áƒ£áƒ—áƒ®áƒ”</td><td><strong>${e.qCut.toFixed(2)}Â°</strong></td></tr>`;
  html+=`</tbody></table>`;
  if(e.pCut>50 || e.qCut>50) html+=`<div class="note warning">âš ï¸ <strong>áƒ§áƒ£áƒ áƒáƒ“áƒ¦áƒ”áƒ‘áƒ!</strong> áƒ­áƒ áƒ˜áƒ¡ áƒ™áƒ£áƒ—áƒ®áƒ” > 50Â°. áƒ’áƒáƒ›áƒáƒ˜áƒ§áƒ”áƒœáƒ” áƒ¤áƒ˜áƒ¥áƒ¡áƒ˜áƒ áƒ”áƒ‘áƒ£áƒšáƒ˜ áƒ™áƒšáƒ”áƒ›áƒ˜.</div>`;
  html+=`<h3>ğŸ“Š áƒ§áƒ•áƒ”áƒšáƒ áƒ¬áƒ•áƒ”áƒ áƒ˜áƒ¡ áƒ“áƒ”áƒ¢áƒáƒšáƒ”áƒ‘áƒ˜</h3>`;
  html+=`<table><thead><tr><th>áƒ¬áƒ•áƒ”áƒ áƒ˜</th><th>áƒ¨áƒ˜áƒ“áƒ áƒ™áƒ£áƒ—áƒ®áƒ”</th><th>áƒ­áƒ áƒ˜áƒ¡ áƒ™áƒ£áƒ—áƒ®áƒ”</th></tr></thead><tbody>`;
  for(const vName in data.vertices){
    const v=data.vertices[vName];
    html+=`<tr><td><strong>${vName}</strong></td><td>${v.interior_deg.toFixed(2)}Â°</td><td><strong>${v.cut_deg.toFixed(2)}Â°</strong></td></tr>`;
  }
  html+=`</tbody></table>`;
  resultsEl.innerHTML=html;
}

/* ---------- input parsing ---------- */
function parsePositive(...ids){return ids.map(id=>{
  const val=Number((el(id).value||'').toString().trim());
  if(Number.isFinite(val)&&val>0) return val;
  throw new Error('áƒ¨áƒ”áƒáƒ•áƒ¡áƒ”áƒ— áƒ§áƒ•áƒ”áƒšáƒ áƒ•áƒ”áƒšáƒ˜ áƒ“áƒáƒ“áƒ”áƒ‘áƒ˜áƒ—áƒ˜ áƒ áƒ˜áƒªáƒ®áƒ•áƒ”áƒ‘áƒ˜áƒ—');
});}

/* ---------- UI wiring ---------- */
document.querySelectorAll('.shape-btn').forEach(btn=>{
  btn.addEventListener('click',()=>{
    state.currentShape=btn.dataset.shape;
    document.querySelectorAll('.shape-btn').forEach(b=>b.classList.toggle('active',b===btn));
    document.getElementById('triTypeSelector').classList.toggle('active',state.currentShape==='triangle');
    document.getElementById('quadInputs').classList.toggle('active',state.currentShape==='quad');
    updateTriangleInputsUI();
    resultsEl.innerHTML='áƒáƒ˜áƒ áƒ©áƒ˜áƒ” áƒ¤áƒ˜áƒ’áƒ£áƒ áƒ, áƒ©áƒáƒ¬áƒ”áƒ áƒ” áƒ–áƒáƒ›áƒ”áƒ‘áƒ˜ áƒ“áƒ áƒ“áƒáƒáƒ­áƒ˜áƒ áƒ” "áƒ’áƒáƒ›áƒáƒ—áƒ•áƒšáƒáƒ¡" ğŸ‘†';
    svgGroup.innerHTML=''; edgeBtnsContainer.innerHTML=''; state.lastComputation=null;
  });
});

document.querySelectorAll('.tri-type-btn').forEach(btn=>{
  btn.addEventListener('click',()=>{
    state.currentTriType=btn.dataset.type;
    document.querySelectorAll('.tri-type-btn').forEach(b=>b.classList.toggle('active',b===btn));
    updateTriangleInputsUI();
  });
});

function updateTriangleInputsUI(){
  ['triangleCustom','triangleRight','triangleEquilateral','triangleIsosceles'].forEach(id=> el(id).classList.remove('active'));
  if(state.currentShape==='triangle'){
    if(state.currentTriType==='custom') el('triangleCustom').classList.add('active');
    else if(state.currentTriType==='right') el('triangleRight').classList.add('active');
    else if(state.currentTriType==='equilateral') el('triangleEquilateral').classList.add('active');
    else if(state.currentTriType==='isosceles') el('triangleIsosceles').classList.add('active');
  }
}

/* ---------- calc & reset ---------- */
el('calcBtn').addEventListener('click',()=>{
  try{
    let data;
    if(state.currentShape==='triangle'){
      if(state.currentTriType==='right'){
        const [h,w]=parsePositive('tri_right_height','tri_right_width');
        data=computeTriangleRightFromBaseHeight(w,h);
      } else if(state.currentTriType==='equilateral'){
        const [s]=parsePositive('tri_eq_side'); data=computeTriangle(s,s,s);
      } else if(state.currentTriType==='isosceles'){
        const [base,side]=parsePositive('tri_iso_base','tri_iso_side');
        if(side+side<=base) throw new Error('áƒáƒ áƒáƒ¡áƒ¬áƒáƒ áƒ˜ áƒ–áƒáƒ›áƒ”áƒ‘áƒ˜: áƒáƒ áƒ˜ áƒ’áƒ•áƒ”áƒ áƒ“áƒ˜áƒ¡ áƒ¯áƒáƒ›áƒ˜ áƒ£áƒœáƒ“áƒ áƒáƒ¦áƒ”áƒ›áƒáƒ¢áƒ”áƒ‘áƒáƒ“áƒ”áƒ¡ áƒ¤áƒ£áƒ«áƒ”áƒ¡');
        data=computeTriangle(base,side,side);
      } else {
        const [a,b,c]=parsePositive('tri_a','tri_b','tri_c');
        if(a+b<=c||a+c<=b||b+c<=a) throw new Error('áƒáƒ áƒáƒ¡áƒ¬áƒáƒ áƒ˜ áƒ¡áƒáƒ›áƒ™áƒ£áƒ—áƒ®áƒ”áƒ“áƒ˜áƒ¡ áƒ’áƒ•áƒ”áƒ áƒ“áƒ”áƒ‘áƒ˜');
        data=computeTriangle(a,b,c);
      }
    } else {
      const [a,b,h1,h2]=parsePositive('quad_a','quad_b','quad_h1','quad_h2');
      data=computeQuad(a,b,h1,h2);
    }
    state.lastComputation=data;
    createEdgeButtons(data);
    renderSVG(data);
    renderResults(data);
  }catch(err){
    resultsEl.innerHTML=`<div style="color:#d32f2f;padding:10px;background:#ffebee;border-radius:8px">âŒ ${err.message}</div>`;
    console.error(err);
  }
});

el('resetBtn').addEventListener('click',()=>{
  ['tri_a','tri_b','tri_c','tri_right_height','tri_right_width','tri_eq_side','tri_iso_base','tri_iso_side','quad_a','quad_b','quad_h1','quad_h2'].forEach(id=>{
    const elIn=el(id); if(!elIn) return;
    const defaults={tri_a:800,tri_b:900,tri_c:1000,tri_right_height:1500,tri_right_width:1000,tri_eq_side:1000,tri_iso_base:1200,tri_iso_side:1000,quad_a:800,quad_b:950,quad_h1:1500,quad_h2:1500};
    elIn.value=defaults[id];
  });
  resultsEl.innerHTML='áƒáƒ˜áƒ áƒ©áƒ˜áƒ” áƒ¤áƒ˜áƒ’áƒ£áƒ áƒ, áƒ©áƒáƒ¬áƒ”áƒ áƒ” áƒ–áƒáƒ›áƒ”áƒ‘áƒ˜ áƒ“áƒ áƒ“áƒáƒáƒ­áƒ˜áƒ áƒ” "áƒ’áƒáƒ›áƒáƒ—áƒ•áƒšáƒáƒ¡" ğŸ‘†';
  svgGroup.innerHTML=''; edgeBtnsContainer.innerHTML=''; state.lastComputation=null;
});

/* ---------- init ---------- */
updateTriangleInputsUI();
</script>

</body>
</html>
